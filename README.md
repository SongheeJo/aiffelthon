

<h1 align="center"> <br>ë¹µ RD(Respiratory Disease)?</h1>
<h3 align="center"> ğŸ¥¨ Team bAIkery ğŸ¥¨</h3>
<h5 align="center"> ì¡°ì†¡í¬ | ì˜¤ì›ì§„ | ì¥í˜œì„  | ìµœì •ì¸ </h5>
<h5 align="center">
ëª¨ë‘ì˜ ì—°êµ¬ì†Œ AIFFEL X ìŠ¤ë§ˆíŠ¸ì‚¬ìš´ë“œ<br>
í˜¸í¡ìŒìœ¼ë¡œ ì§ˆë³‘ ë¶„ë¥˜í•˜ê¸°<br>
</h5>
<br>

<div align="center">
  

</div>

## Description
<div align="center">
  

</div>

- ì§„í–‰ê¸°ê°„: 22.04.25 ~ 06.10
- ê°œë°œ ëª©ì : í˜¸í¡ìŒ ë°ì´í„°ë¥¼ ê¸°ë°˜ìœ¼ë¡œ ì •ìƒìŒê³¼ ë¹„ì •ìƒìŒì„ ê°ë³„í•˜ì—¬ ì§ˆë³‘ì„ ë¶„ë¥˜í•˜ê¸° ìœ„í•¨
- ê°œë°œ ê°œìš”:
  
  í˜¸í¡ìŒì€ ê³µê¸°ì˜ íë¦„, í ë‚´ë¶€ì˜ ì¡°ì§ ë³€í™”, í ë‚´ ë¶„ë¹„ë¬¼ì˜ ìœ„ì¹˜ì™€ ì§ì ‘ì ì¸ ê´€ë ¨ì´ ìˆì–´ í˜¸í¡ê¸° ê±´ê°• ë° í˜¸í¡ê¸° ì§ˆí™˜ì˜ ì¤‘ìš” ì§€í‘œë¡œ ì‚¬ìš©ë©ë‹ˆë‹¤. ì´ëŸ¬í•œ í˜¸í¡ìŒì„ ì „ë¬¸ ê¸°ê¸° í˜¹ì€ ê°€ì •ìš© ê¸°ê¸°ë¥¼ ì´ìš©í•´ ë…¹ìŒí•©ë‹ˆë‹¤. ê·¸ë¦¬ê³  í•´ë‹¹ í˜¸í¡ìŒì„ ê¸°ë°˜ìœ¼ë¡œ íì˜ ì´ìƒì—¬ë¶€ë¥¼ íŒë‹¨í•˜ê³ , 1ì°¨ì ìœ¼ë¡œ ì§ˆë³‘ì˜ ìœ ë¬´ë¥¼ ì˜ˆì¸¡ì„ í•´ë´„ìœ¼ë¡œì¨ ì§ˆë³‘ í™•ì‚° ë°©ì§€ì— ë„ì›€ì„ ì¤„ ìˆ˜ ìˆìŠµë‹ˆë‹¤. ì´ì™€ ê°™ì€ ë°ì´í„°ë¥¼ ì´ìš©í•´ í˜¸í¡ìŒ ë¶„ë¥˜ë¥¼ ìë™ìœ¼ë¡œ ì§„í–‰í•˜ëŠ” ë¶„ì„ ëª¨ë¸ì„ êµ¬ì¶•í•©ë‹ˆë‹¤.
- ê³¼ì •: ì „ì²˜ë¦¬ > í´ë˜ìŠ¤ ë°¸ëŸ°ì‹± ì²˜ë¦¬ > íŠ¹ì§• ì¶”ì¶œ > ëª¨ë¸ë§ > ê²°ê³¼ í™•ì¸

## About Aiffelthon
**<í‰ê°€ ë°©ì‹>** 

- [ì°¸ì¡° ì†ŒìŠ¤](https://github.com/Shivam-316/Respiratory-Disease-Detection) ì‹¤í–‰ í›„ ê²°ê³¼ í™•ì¸
- ë‹¤ì–‘í•œ ëª¨ë¸ ì ìš© í›„,  ê²°ê³¼ ë¹„êµ
- ê³¼ì—… : ì§ˆë³‘ë¶„ë¥˜ ëª¨ë¸ ì •í™•ë„(accuracy)ëŠ” 95% ì´ìƒ ë‹¬ì„±
- ë¯¼ê°ë„(sensitivity)ì™€ íŠ¹ì´ë„(specificity)ë¥¼ ê³„ì‚°í•  ê²ƒ
- ì¶”ê°€ ê³¼ì—… : ì†Œë¦¬ì—ì„œ ìˆ˜í¬ìŒ(crackle)ì™€ ì²œëª…ìŒ(wheeze) ì¡´ì¬ ìœ ë¬´ í™•ì¸


## 1. Dataset 

- ë°ì´í„°ì…‹: [Respiratory Sound Database](https://www.kaggle.com/datasets/vbookshelf/respiratory-sound-database) 
- 10ì´ˆì—ì„œ 90ì´ˆì˜ 920ê°œì˜ ë…¹ìŒ íŒŒì¼(126ëª…ì˜ í™˜ì) ìˆ˜ë¡
- ê°ê°ì˜ ë…¹ìŒ íŒŒì¼ì— ëŒ€í•œ ì£¼ì„ì´ í¬í•¨ë¨
- 6898ê°œì˜ í˜¸í¡ ì£¼ê¸°ë¥¼ í¬í•¨í•´ ì´ 5.5ì‹œê°„ ë¶„ëŸ‰ì˜ ë…¹ìŒ ê¸°ë¡ 
- 1864ê°œì—ëŠ” ìˆ˜í¬ìŒ(crackle), 886ê°œì—ëŠ” ì²œëª…ìŒ(wheeze), 506ê°œì—ëŠ” ìˆ˜í¬ìŒ(crackle) ì™€ ì²œëª…ìŒ(wheeze) ì´ ëª¨ë‘ í¬í•¨ë˜ì–´ ìˆìŒ.Â 
- wheeze - High-pitched, **100 -2500Hz**ì˜ ì£¼íŒŒìˆ˜ ëŒ€ì—­ê³¼ **80msec ì´ìƒì˜ ì§€ì†ì‹œê°„**
- crackle - High-pitched, crackleì˜ **ì§€ì†ì‹œê°„**ì€ **20 msë³´ë‹¤ ë” ë‚®ê³ ** ì£¼íŒŒìˆ˜ ëŒ€ì—­ì€ **100ì™€ 200 Hz** ì‚¬ì´
- ë°ì´í„°ì—ëŠ” ê¹¨ë—í•œ í˜¸í¡ìŒë§Œì„ í¬í•¨í•œ ë…¹ìŒ íŒŒì¼ê³¼ ì‹¤ì œ ìƒí™œ ì¡°ê±´ì„ ë°˜ì˜í•´ ì†ŒìŒì´ í¬í•¨ëœ ë…¹ìŒ íŒŒì¼ì´ ìˆìŒ. 
- í™˜ìëŠ” ëª¨ë“  ì—°ë ¹ëŒ€ë¥¼ í¬í•¨

## 2. ì „ì²˜ë¦¬
- down sampling(16000Hz)
- zero padding
- 5th Butterworth filter

## 3. í´ë˜ìŠ¤ ë°¸ëŸ°ì‹± ì²˜ë¦¬
- smart padding + duplicated padding
- concatenation-based augmentation
- train/test split(stratify=normal/crackle/wheeze/both í´ë˜ìŠ¤ ë¹„ìœ¨ëŒ€ë¡œ)
- augmentation(shiftaug, speedaug)

## 4. íŠ¹ì§• ì¶”ì¶œ
- mel feature extraction
- blank region clipping
- frequency/time masking

## 5. ëª¨ë¸ë§
- transfer learning(ResNet34)
- ResNet

## 6. ê²°ê³¼ í™•ì¸ (test.py)
1) Task 1 : Pulmonary Disease classification

<p align="center"><img width="392" alt="pulmonary_disease_classification_report" src="https://user-images.githubusercontent.com/97088101/172894322-12074c59-ad19-4a22-8451-86bf03397f3c.png"></p>


2) Task 2 : Abnormal Lung sounds classification (additional)
 - First_trial without smart_padding
<img width="527" alt="first_trial_simple_CNN(2)" src="https://user-images.githubusercontent.com/97088101/172894713-acee990e-5e25-4ac6-842d-de0435423313.png">

 <img width="234" alt="first_trial_simple_CNN(1)" src="https://user-images.githubusercontent.com/97088101/172894752-4edb56bc-7a36-4432-91d7-a031224caf39.png">

 - Seocnd_trial with smart_padding
 <img width="518" alt="second_trial_with_smart_padding(1)" src="https://user-images.githubusercontent.com/97088101/172894805-72c5f781-13fd-4a1f-9db1-8cf2b27bae09.png">
<img width="230" alt="second_trial_with_smart_padding(2)" src="https://user-images.githubusercontent.com/97088101/172894831-60cf3552-4c20-4822-91d0-d12bfbff998b.png">

 
## 7. ê²° ë¡ 

- Medlcal dataë¥¼ ì²« ë²ˆì§¸ í”„ë¡œì íŠ¸ë¡œ ì§„í–‰í•˜ë©°, sound dataì— ëŒ€í•œ ì „ë°˜ì ì¸ ì´í•´ì™€ ë‹¤ì–‘í•œ pre-processing ë°©ë²•ì„ ì‹œë„í•´ë³´ëŠ” ê²ƒì„ ëª©í‘œë¡œ í•˜ì˜€ìŠµë‹ˆë‹¤.
- RespireNet ë…¼ë¬¸ ë‚´ìš©ì„ í† ëŒ€ë¡œ, concantenated augmentationì„ í¬í•¨í•œ, ë‹¤ì–‘í•œ augmentation ê¸°ë²•ì„ ì‹œë„í•´ ë³´ì•˜ìŠµë‹ˆë‹¤.
- ì²«ë²ˆì§¸ ê³¼ì—…ì¸, ì§ˆë³‘ë¶„ë¥˜ ëª¨ë¸ì—ì„œ ë‹¨ìˆœíˆ, Resnet CNN modelë¡œ ë°”ê¿ˆìœ¼ë¡œì¨ ì¶”ê°€ì  ì „ì²˜ë¦¬ ì—†ì´ 96% ì— ë‹¬ì„±í•˜ëŠ” ì„±ê³¼ë¥¼ ë³´ì˜€ìŠµë‹ˆë‹¤.
- ë‘ë²ˆì§¸ ê³¼ì—…ì—ì„œëŠ” Resnet ëª¨ë¸ì—ì„œ ë³´ë‹¤ simple í•œ CNN modelì´ ë” ë†’ì€ ì„±ëŠ¥ì„ ë³´ì˜€ìŠµë‹ˆë‹¤.
- Wheezing ë° Crackle sounds classification modelì—ì„œ ë†’ì€ ì„±ëŠ¥ì„ ë³´ê¸° í˜ë“  ì´ìœ ëŠ”, ë³¸ ë¹„ì •ìƒì ì¸ í˜¸í¡ë“¤ì€ fine -> moderate -> coarseí•œ ë‹¨ê³„ë¥¼ ê°€ì§€ë©°, ì£¼íŒŒìˆ˜ ì˜ì—­ëŒ€ ë˜í•œ ë¹„ìŠ·í•˜ê²Œ í¬í•¨í•˜ê³  ìˆì–´ ë†’ì€ ì„±ëŠ¥ì„ í™•ì¸í•˜ê¸°ê¹Œì§€ëŠ” ë§ì€ ì–´ë ¤ì›€ì´ ìˆìŒìœ¼ë¡œ íŒë‹¨ë©ë‹ˆë‹¤.
- Smart_padding ì„ êµ¬í˜„í•˜ì—¬ trainì…‹ìœ¼ë¡œ í™œìš©í•˜ì—¬ í›ˆë ¨í•œ ê²°ê³¼, wheezing & crackle soundê°€ ë‘˜ ë‹¤ ìˆëŠ” both classì— ëŒ€í•´ ë†’ì€ recall & f1-scoreë¥¼ ë³´ì˜€ìœ¼ë‚˜, wheezing classì— ëŒ€í•´ì„œ ì ìˆ˜ê°€ ë‚®ì•„ì§€ëŠ” ê²ƒì„ í™•ì¸í•˜ì˜€ìŠµë‹ˆë‹¤.
- í•´ì»¤í†¤ ë°œí‘œë¥¼ í†µí•˜ì—¬, ë’¤ëŠ¦ê²Œ, data splitì„ ë°ì´í„°ì–‘ ê¸°ì¤€ì´ ì•„ë‹Œ, patient_id(PID)ë¥¼ ê¸°ì¤€ìœ¼ë¡œ ë‚˜ëˆ„ì–´ì•¼ ëª¨ë¸ì˜ ì„±ëŠ¥ë„ í–¥ìƒë  ìˆ˜ ìˆìŒì„ ì•Œê²Œ ë˜ì—ˆìœ¼ë©°, í–¥í›„ ë‹¤ì–‘í•œ model building ê³¼ í•¨ê»˜ ì¶”ê°€ì ì¸ testë¥¼ í•´ë³¼ ì˜ˆì •ì…ë‹ˆë‹¤.


## 8. ì°¸ê³  ë…¼ë¬¸
- A Window Width Optimized S-Transform(2008)
- Classification of lung sounds using convolutional neural networks(2017)
- respireNet(2020)
- DC-UNet: Rethinking the U-Net Architecture with Dual Channel Efficient CNN for Medical Images Segmentation(2020)
- LungRN+NL: An Improved Adventitious Lung Sound Classification Using Non-Local Block ResNet Neural Network with Mixup Data Augmentation(2020)
- FILTERAUGMENT: AN ACOUSTIC ENVIRONMENTAL DATA AUGMENTATION METHOD(2021)


<br>
<br>
<br>
